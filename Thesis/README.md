The final version of the thesis.
